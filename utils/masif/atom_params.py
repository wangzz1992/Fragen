"""
atom_params.py: Atom-level parameters for surface feature computation.
Contains AMBER force field partial charges and hydrophobicity labels.
"""

# AMBER ff14SB partial charges for standard amino acids
# Source: User-provided based on AMBER force field
ATOM_PARTIAL_CHARGES = {
    "ALA": {
        "N": -0.4157,   # 主链N
        "H": 0.2719,    # 主链H
        "CA": 0.0337,
        "HA": 0.0823,
        "CB": -0.1825,
        "HB1": 0.0603,
        "HB2": 0.0603,
        "HB3": 0.0603,
        "C": 0.5973,
        "O": -0.5679,
    },
    "ARG": {
        "N": -0.3479,   # 主链N
        "H": 0.2747,    # 主链H
        "CA": -0.2637,
        "HA": 0.1560,
        "CB": -0.0007,
        "HB2": 0.0327,
        "HB3": 0.0327,
        "CG": 0.0390,
        "HG2": 0.0285,
        "HG3": 0.0285,
        "CD": 0.0486,
        "HD2": 0.0687,
        "HD3": 0.0687,
        "NE": -0.5295,
        "HE": 0.3456,
        "CZ": 0.8706,
        "NH1": -0.8627,
        "HH11": 0.4478,
        "HH12": 0.4478,
        "NH2": -0.8627,
        "HH21": 0.4478,
        "HH22": 0.4478,
        "C": 0.7341,
        "O": -0.5894,
    },
    "ASN": {
        "N": -0.4157,   # 主链N
        "H": 0.2719,    # 主链H
        "CA": 0.0143,
        "HA": 0.1048,
        "CB": -0.2041,
        "HB2": 0.0797,
        "HB3": 0.0797,
        "CG": 0.7130,
        "OD1": -0.5931,
        "ND2": -0.9191,
        "HD21": 0.4196,
        "HD22": 0.4196,
        "C": 0.5973,
        "O": -0.5679,
    },
    "ASP": {
        "N": -0.5163,   # 主链N
        "H": 0.2936,    # 主链H
        "CA": 0.0381,
        "HA": 0.0880,
        "CB": -0.0303,
        "HB2": -0.0122,
        "HB3": -0.0122,
        "CG": 0.7994,
        "OD1": -0.8014,
        "OD2": -0.8014,
        "C": 0.5366,
        "O": -0.5819,
    },
    "CYS": {
        "N": -0.4157,   # 主链N
        "H": 0.2719,    # 主链H
        "CA": 0.0213,
        "HA": 0.1124,
        "CB": -0.1231,
        "HB2": 0.1112,
        "HB3": 0.1112,
        "SG": -0.3119,
        "HG": 0.1933,
        "C": 0.5973,
        "O": -0.5679,
    },
    "GLN": {
        "N": -0.4157,   # 主链N
        "H": 0.2719,    # 主链H
        "CA": 0.0031,
        "HA": 0.0850,
        "CB": -0.0036,
        "HB2": 0.0171,
        "HB3": 0.0171,
        "CG": -0.0645,
        "HG2": 0.0352,
        "HG3": 0.0352,
        "CD": 0.6951,
        "OE1": -0.6086,
        "NE2": -0.9407,
        "HE21": 0.4251,
        "HE22": 0.4251,
        "C": 0.5973,
        "O": -0.5679,
    },
    "GLU": {
        "N": -0.5163,   # 主链N
        "H": 0.2936,    # 主链H
        "CA": 0.0397,
        "HA": 0.1105,
        "CB": 0.0560,
        "HB2": -0.0173,
        "HB3": -0.0173,
        "CG": 0.0136,
        "HG2": -0.0425,
        "HG3": -0.0425,
        "CD": 0.8054,
        "OE1": -0.8188,
        "OE2": -0.8188,
        "C": 0.5366,
        "O": -0.5819,
    },
    "GLY": {
        "N": -0.4157,   # 主链N
        "H": 0.2719,    # 主链H
        "CA": -0.0252,
        "HA2": 0.0698,
        "HA3": 0.0698,
        "C": 0.5973,
        "O": -0.5679,
    },
    "HIS": {
        "N": -0.4157,   # 主链N
        "H": 0.2719,    # 主链H
        "CA": 0.0188,
        "HA": 0.0881,
        "CB": -0.0462,
        "HB2": 0.0402,
        "HB3": 0.0402,
        "CG": -0.0266,
        "ND1": -0.3811,
        "HD1": 0.3649,
        "CE1": 0.2057,
        "HE1": 0.1392,
        "NE2": -0.5727,
        "CD2": 0.1292,
        "HD2": 0.1147,
        "C": 0.5973,
        "O": -0.5679,
    },
    "ILE": {
        "N": -0.4157,   # 主链N
        "H": 0.2719,    # 主链H
        "CA": 0.0597,
        "HA": 0.0869,
        "CB": 0.1303,
        "HB": 0.0187,
        "CG2": -0.3204,
        "HG21": 0.0882,
        "HG22": 0.0882,
        "HG23": 0.0882,
        "CG1": -0.0430,
        "HG12": 0.0236,
        "HG13": 0.0236,
        "CD1": -0.0660,
        "HD11": 0.1860,
        "HD12": 0.1860,
        "HD13": 0.1860,
        "C": 0.5973,
        "O": -0.5679,
    },
    "LEU": {
        "N": -0.4157,   # 主链N
        "H": 0.2719,    # 主链H
        "CA": -0.0518,
        "HA": 0.0922,
        "CB": -0.1102,
        "HB2": 0.0457,
        "HB3": 0.0457,
        "CG": 0.3531,
        "HG": -0.0361,
        "CD1": -0.4121,
        "HD11": 0.1000,
        "HD12": 0.1000,
        "HD13": 0.1000,
        "CD2": -0.4121,
        "HD21": 0.1000,
        "HD22": 0.1000,
        "HD23": 0.1000,
        "C": 0.5973,
        "O": -0.5679,
    },
    "LYS": {
        "N": -0.3479,   # 主链N
        "H": 0.2747,    # 主链H
        "CA": -0.2400,
        "HA": 0.1426,
        "CB": -0.0094,
        "HB2": 0.0362,
        "HB3": 0.0362,
        "CG": 0.0187,
        "HG2": 0.0103,
        "HG3": 0.0103,
        "CD": -0.0479,
        "HD2": 0.0621,
        "HD3": 0.0621,
        "CE": -0.0143,
        "HE2": 0.1135,
        "HE3": 0.1135,
        "NZ": -0.3854,
        "HZ1": 0.3400,
        "HZ2": 0.3400,
        "HZ3": 0.3400,
        "C": 0.7341,
        "O": -0.5894,
    },
    "MET": {
        "N": -0.4157,   # 主链N
        "H": 0.2719,    # 主链H
        "CA": -0.0237,
        "HA": 0.0880,
        "CB": 0.0342,
        "HB2": 0.0241,
        "HB3": 0.0241,
        "CG": 0.0018,
        "HG2": 0.0440,
        "HG3": 0.0440,
        "SD": -0.2737,
        "CE": -0.0536,
        "HE1": 0.0684,
        "HE2": 0.0684,
        "HE3": 0.0684,
        "C": 0.5973,
        "O": -0.5679,
    },
    "PHE": {
        "N": -0.4157,   # 主链N
        "H": 0.2719,    # 主链H
        "CA": -0.0024,
        "HA": 0.0978,
        "CB": -0.0343,
        "HB2": 0.0295,
        "HB3": 0.0295,
        "CG": 0.0118,
        "CD1": -0.1256,
        "HD1": 0.1330,
        "CE1": -0.1704,
        "HE1": 0.1430,
        "CZ": -0.1072,
        "HZ": 0.1297,
        "CE2": -0.1704,
        "HE2": 0.1430,
        "CD2": -0.1256,
        "HD2": 0.1330,
        "C": 0.5973,
        "O": -0.5679,
    },
    "PRO": {
        "N": -0.2548,   # 主链N
        "CD": 0.0192,
        "HD2": 0.0391,
        "HD3": 0.0391,
        "CG": 0.0189,
        "HG2": 0.0213,
        "HG3": 0.0213,
        "CB": -0.0070,
        "HB2": 0.0253,
        "HB3": 0.0253,
        "CA": -0.0266,
        "HA": 0.0641,
        "C": 0.5896,
        "O": -0.5748,
    },
    "SER": {
        "N": -0.4157,   # 主链N (corrected from -0.2548 to standard value)
        "H": 0.2719,    # 主链H
        "CA": -0.0249,
        "HA": 0.0843,
        "CB": 0.2117,
        "HB2": 0.0352,
        "HB3": 0.0352,
        "OG": -0.6546,
        "HG": 0.4275,
        "C": 0.5973,
        "O": -0.5679,
    },
    "THR": {
        "N": -0.4157,   # 主链N
        "H": 0.2719,    # 主链H
        "CA": -0.0389,
        "HA": 0.1007,
        "CB": 0.3654,
        "HB": 0.0043,
        "CG2": -0.2438,
        "HG21": 0.0642,
        "HG22": 0.0642,
        "HG23": 0.0642,
        "OG1": -0.6761,
        "HG1": 0.4102,
        "C": 0.5973,
        "O": -0.5679,
    },
    "TRP": {
        "N": -0.4157,   # 主链N
        "H": 0.2719,    # 主链H
        "CA": -0.0275,
        "HA": 0.1123,
        "CB": -0.0050,
        "HB2": 0.0339,
        "HB3": 0.0339,
        "CG": -0.1415,
        "CD1": -0.1638,
        "HD1": 0.2062,
        "NE1": -0.3418,
        "HE1": 0.3412,
        "CE2": 0.1380,
        "CZ2": -0.2601,
        "HZ2": 0.1572,
        "CH2": -0.1134,
        "HH2": 0.1417,
        "CZ3": -0.1972,
        "HZ3": 0.1447,
        "CE3": -0.2387,
        "HE3": 0.1700,
        "CD2": 0.1243,
        "C": 0.5973,
        "O": -0.5679,
    },
    "TYR": {
        "N": -0.4157,   # 主链N
        "H": 0.2719,    # 主链H
        "CA": -0.0014,
        "HA": 0.0876,
        "CB": -0.0152,
        "HB2": 0.0295,
        "HB3": 0.0295,
        "CG": -0.0011,
        "CD1": -0.1906,
        "HD1": 0.1699,
        "CE1": -0.2341,
        "HE1": 0.1656,
        "CZ": 0.3226,
        "OH": -0.5579,
        "HH": 0.3992,
        "CE2": -0.2341,
        "HE2": 0.1656,
        "CD2": -0.1906,
        "HD2": 0.1699,
        "C": 0.5973,
        "O": -0.5679,
    },
    "VAL": {
        "N": -0.4157,   # 主链N
        "H": 0.2719,    # 主链H
        "CA": -0.0875,
        "HA": 0.0969,
        "CB": 0.2985,
        "HB": -0.0297,
        "CG1": -0.3192,
        "HG11": 0.0791,
        "HG12": 0.0791,
        "HG13": 0.0791,
        "CG2": -0.3192,
        "HG21": 0.0791,
        "HG22": 0.0791,
        "HG23": 0.0791,
        "C": 0.5973,
        "O": -0.5679,
    },
}

# Atom-level hydrophobicity labels
# +1 = hydrophobic, -1 = hydrophilic/polar
# Based on user-provided classification
ATOM_HYDROPHOBICITY = {
    "ALA": {
        "N": -1,   # 主链N
        "H": -1,   # 主链H
        "CA": 1,
        "HA": 1,
        "CB": 1,
        "HB1": 1,
        "HB2": 1,
        "HB3": 1,
        "C": -1,
        "O": -1,
    },
    "ARG": {
        "N": -1,   # 主链N
        "H": -1,   # 主链H
        "CA": 1,
        "HA": 1,
        "CB": 1,
        "HB2": 1,
        "HB3": 1,
        "CG": 1,
        "HG2": 1,
        "HG3": 1,
        "CD": 1,
        "HD2": 1,
        "HD3": 1,
        "NE": -1,
        "HE": -1,
        "CZ": -1,
        "NH1": -1,
        "HH11": -1,
        "HH12": -1,
        "NH2": -1,
        "HH21": -1,
        "HH22": -1,
        "C": -1,
        "O": -1,
    },
    "ASN": {
        "N": -1,   # 主链N
        "H": -1,   # 主链H
        "CA": 1,
        "HA": 1,
        "CB": 1,
        "HB2": 1,
        "HB3": 1,
        "CG": -1,
        "OD1": -1,
        "ND2": -1,
        "HD21": -1,
        "HD22": -1,
        "C": -1,
        "O": -1,
    },
    "ASP": {
        "N": -1,   # 主链N
        "H": -1,   # 主链H
        "CA": 1,
        "HA": 1,
        "CB": 1,
        "HB2": 1,
        "HB3": 1,
        "CG": -1,
        "OD1": -1,
        "OD2": -1,
        "C": -1,
        "O": -1,
    },
    "CYS": {
        "N": -1,   # 主链N
        "H": -1,   # 主链H
        "CA": 1,
        "HA": 1,
        "CB": 1,
        "HB2": 1,
        "HB3": 1,
        "SG": -1,
        "HG": -1,
        "C": -1,
        "O": -1,
    },
    "GLN": {
        "N": -1,   # 主链N
        "H": -1,   # 主链H
        "CA": 1,
        "HA": 1,
        "CB": 1,
        "HB2": 1,
        "HB3": 1,
        "CG": 1,
        "HG2": 1,
        "HG3": 1,
        "CD": -1,
        "OE1": -1,
        "NE2": -1,
        "HE21": -1,
        "HE22": -1,
        "C": -1,
        "O": -1,
    },
    "GLU": {
        "N": -1,   # 主链N
        "H": -1,   # 主链H
        "CA": 1,
        "HA": 1,
        "CB": 1,
        "HB2": 1,
        "HB3": 1,
        "CG": 1,
        "HG2": 1,
        "HG3": 1,
        "CD": -1,
        "OE1": -1,
        "OE2": -1,
        "C": -1,
        "O": -1,
    },
    "GLY": {
        "N": -1,   # 主链N
        "H": -1,   # 主链H
        "CA": 1,
        "HA2": 1,
        "HA3": 1,
        "C": -1,
        "O": -1,
    },
    "HIS": {
        "N": -1,   # 主链N
        "H": -1,   # 主链H
        "CA": 1,
        "HA": 1,
        "CB": 1,
        "HB2": 1,
        "HB3": 1,
        "CG": 1,
        "ND1": -1,
        "HD1": -1,
        "CE1": -1,
        "HE1": -1,
        "NE2": -1,
        "CD2": 1,
        "HD2": 1,
        "C": -1,
        "O": -1,
    },
    "ILE": {
        "N": -1,   # 主链N
        "H": -1,   # 主链H
        "CA": 1,
        "HA": 1,
        "CB": 1,
        "HB": 1,
        "CG2": 1,
        "HG21": 1,
        "HG22": 1,
        "HG23": 1,
        "CG1": 1,
        "HG12": 1,
        "HG13": 1,
        "CD1": 1,
        "HD11": 1,
        "HD12": 1,
        "HD13": 1,
        "C": -1,
        "O": -1,
    },
    "LEU": {
        "N": -1,   # 主链N
        "H": -1,   # 主链H
        "CA": 1,
        "HA": 1,
        "CB": 1,
        "HB2": 1,
        "HB3": 1,
        "CG": 1,
        "HG": 1,
        "CD1": 1,
        "HD11": 1,
        "HD12": 1,
        "HD13": 1,
        "CD2": 1,
        "HD21": 1,
        "HD22": 1,
        "HD23": 1,
        "C": -1,
        "O": -1,
    },
    "LYS": {
        "N": -1,   # 主链N
        "H": -1,   # 主链H
        "CA": 1,
        "HA": 1,
        "CB": 1,
        "HB2": 1,
        "HB3": 1,
        "CG": 1,
        "HG2": 1,
        "HG3": 1,
        "CD": 1,
        "HD2": 1,
        "HD3": 1,
        "CE": 1,
        "HE2": 1,
        "HE3": 1,
        "NZ": -1,
        "HZ1": -1,
        "HZ2": -1,
        "HZ3": -1,
        "C": -1,
        "O": -1,
    },
    "MET": {
        "N": -1,   # 主链N
        "H": -1,   # 主链H
        "CA": 1,
        "HA": 1,
        "CB": 1,
        "HB2": 1,
        "HB3": 1,
        "CG": 1,
        "HG2": 1,
        "HG3": 1,
        "SD": -1,
        "CE": 1,
        "HE1": 1,
        "HE2": 1,
        "HE3": 1,
        "C": -1,
        "O": -1,
    },
    "PHE": {
        "N": -1,   # 主链N
        "H": -1,   # 主链H
        "CA": 1,
        "HA": 1,
        "CB": 1,
        "HB2": 1,
        "HB3": 1,
        "CG": 1,
        "CD1": 1,
        "HD1": 1,
        "CE1": 1,
        "HE1": 1,
        "CZ": 1,
        "HZ": 1,
        "CE2": 1,
        "HE2": 1,
        "CD2": 1,
        "HD2": 1,
        "C": -1,
        "O": -1,
    },
    "PRO": {
        "N": 1,    # PRO主链N is unique (no H)
        "CD": 1,
        "HD2": 1,
        "HD3": 1,
        "CG": 1,
        "HG2": 1,
        "HG3": 1,
        "CB": 1,
        "HB2": 1,
        "HB3": 1,
        "CA": 1,
        "HA": 1,
        "C": -1,
        "O": -1,
    },
    "SER": {
        "N": -1,   # 主链N
        "H": -1,   # 主链H
        "CA": 1,
        "HA": 1,
        "CB": 1,
        "HB2": 1,
        "HB3": 1,
        "OG": -1,
        "HG": -1,
        "C": -1,
        "O": -1,
    },
    "THR": {
        "N": -1,   # 主链N
        "H": -1,   # 主链H
        "CA": 1,
        "HA": 1,
        "CB": 1,
        "HB": 1,
        "CG2": 1,
        "HG21": 1,
        "HG22": 1,
        "HG23": 1,
        "OG1": -1,
        "HG1": -1,
        "C": -1,
        "O": -1,
    },
    "TRP": {
        "N": -1,   # 主链N
        "H": -1,   # 主链H
        "CA": 1,
        "HA": 1,
        "CB": 1,
        "HB2": 1,
        "HB3": 1,
        "CG": 1,
        "CD1": 1,
        "HD1": 1,
        "NE1": -1,
        "HE1": -1,
        "CE2": 1,
        "CZ2": 1,
        "HZ2": 1,
        "CH2": 1,
        "HH2": 1,
        "CZ3": 1,
        "HZ3": 1,
        "CE3": 1,
        "HE3": 1,
        "CD2": 1,
        "C": -1,
        "O": -1,
    },
    "TYR": {
        "N": -1,   # 主链N
        "H": -1,   # 主链H
        "CA": 1,
        "HA": 1,
        "CB": 1,
        "HB2": 1,
        "HB3": 1,
        "CG": 1,
        "CD1": 1,
        "HD1": 1,
        "CE1": 1,
        "HE1": 1,
        "CZ": 1,
        "OH": -1,
        "HH": -1,
        "CE2": 1,
        "HE2": 1,
        "CD2": 1,
        "HD2": 1,
        "C": -1,
        "O": -1,
    },
    "VAL": {
        "N": -1,   # 主链N
        "H": -1,   # 主链H
        "CA": 1,
        "HA": 1,
        "CB": 1,
        "HB": 1,
        "CG1": 1,
        "HG11": 1,
        "HG12": 1,
        "HG13": 1,
        "CG2": 1,
        "HG21": 1,
        "HG22": 1,
        "HG23": 1,
        "C": -1,
        "O": -1,
    },
}


def get_atom_partial_charge(res_name: str, atom_name: str, default: float = 0.0) -> float:
    """
    Get partial charge for an atom.
    
    Args:
        res_name: Residue name (e.g., "ALA", "GLY")
        atom_name: Atom name (e.g., "CA", "CB")
        default: Default value if not found
    
    Returns:
        Partial charge value
    """
    res_name = res_name.strip().upper()
    atom_name = atom_name.strip()
    
    if res_name in ATOM_PARTIAL_CHARGES:
        return ATOM_PARTIAL_CHARGES[res_name].get(atom_name, default)
    return default


def get_atom_hydrophobicity(res_name: str, atom_name: str, default: float = 0.0) -> float:
    """
    Get hydrophobicity label for an atom.
    
    Args:
        res_name: Residue name (e.g., "ALA", "GLY")
        atom_name: Atom name (e.g., "CA", "CB")
        default: Default value if not found
    
    Returns:
        Hydrophobicity label (+1 or -1)
    """
    res_name = res_name.strip().upper()
    atom_name = atom_name.strip()
    
    if res_name in ATOM_HYDROPHOBICITY:
        return ATOM_HYDROPHOBICITY[res_name].get(atom_name, default)
    return default

